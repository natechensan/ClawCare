# ClawCare Default Ruleset — Sensitive Data & PII
#
# Detects unobfuscated personally identifiable information (PII),
# financial data, and other sensitive data patterns that should not
# appear in AI agent extension code or instructions.
#
# These patterns flag hardcoded sensitive data — not references to
# environment variables or config keys (which are expected).

# ── Critical — credentials / secrets hardcoded in source ────

- id: DATA_HARDCODED_AWS_KEY
  severity: critical
  pattern: "(?:AKIA|ABIA|ACCA|ASIA)[0-9A-Z]{16}"
  explanation: Hardcoded AWS access key ID detected.
  remediation: Use environment variables or a secrets manager instead of hardcoding credentials.
  # CWE-798: Use of Hard-coded Credentials

- id: DATA_HARDCODED_PRIVATE_KEY
  severity: critical
  pattern: "-----BEGIN (RSA |EC |DSA |OPENSSH )?PRIVATE KEY-----"
  explanation: Private key embedded in source code.
  remediation: Store private keys in a secrets manager, never commit them to source.
  # CWE-798: Use of Hard-coded Credentials

- id: DATA_HARDCODED_GITHUB_TOKEN
  severity: critical
  pattern: "(ghp_[A-Za-z0-9_]{36}|github_pat_[A-Za-z0-9_]{82})"
  explanation: GitHub personal access token detected in source.
  remediation: Use environment variables for tokens.
  # CWE-798: Use of Hard-coded Credentials

- id: DATA_HARDCODED_GENERIC_SECRET
  severity: high
  pattern: "(?i)(api_key|secret_key|auth_token|access_token|private_key|password)\\s*[:=]\\s*['\"][A-Za-z0-9+/=_-]{16,}['\"]"
  explanation: Possible hardcoded secret or API key in source code.
  remediation: Use environment variables or a secrets manager.
  # CWE-798: Use of Hard-coded Credentials

# ── High — PII patterns ────────────────────────────────────

- id: DATA_SSN
  severity: high
  pattern: "\\b\\d{3}-\\d{2}-\\d{4}\\b"
  explanation: Pattern resembles a US Social Security Number (SSN).
  remediation: Remove or obfuscate SSNs. Never hardcode PII in extension code.
  # CWE-359: Exposure of Private Personal Information to an Unauthorized Actor

- id: DATA_CREDIT_CARD
  severity: high
  pattern: "\\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|6(?:011|5[0-9]{2})[0-9]{12})\\b"
  explanation: Pattern resembles a credit card number (Visa, Mastercard, Amex, Discover).
  remediation: Never hardcode payment card data. Use tokenization.
  # CWE-359: Exposure of Private Personal Information
  # PCI DSS violation

- id: DATA_EMAIL_COLLECTION
  severity: medium
  pattern: "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"
  explanation: Email address detected. May indicate PII collection or hardcoded contact info.
  remediation: Avoid hardcoding email addresses; use configuration or environment variables.
  # CWE-359: Exposure of Private Personal Information

# ── Medium — financial / regulated data ─────────────────────

- id: DATA_IBAN
  severity: medium
  pattern: "\\b[A-Z]{2}\\d{2}[A-Z0-9]{4}\\d{7}([A-Z0-9]?){0,16}\\b"
  explanation: Pattern resembles an International Bank Account Number (IBAN).
  remediation: Never hardcode financial account numbers in source code.

- id: DATA_ROUTING_NUMBER
  severity: medium
  pattern: "(?i)(routing[_\\s-]?number|aba[_\\s-]?number)\\s*[:=]\\s*['\"]?\\d{9}['\"]?"
  explanation: US bank routing number (ABA) detected.
  remediation: Use secure configuration for financial data.

# ── Low — potential data leakage signals ────────────────────

- id: DATA_IP_ADDRESS_LITERAL
  severity: low
  pattern: "\\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b"
  explanation: Hardcoded IP address may expose internal infrastructure details.
  remediation: Use hostnames or configuration for IP addresses.

- id: DATA_PHONE_NUMBER
  severity: low
  pattern: "(?:\\+1[-.\\s]?)?\\(?\\d{3}\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4}"
  explanation: Pattern resembles a US phone number.
  remediation: Avoid hardcoding phone numbers in extension code.
  # CWE-359: Exposure of Private Personal Information
